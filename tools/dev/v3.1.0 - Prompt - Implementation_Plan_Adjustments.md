
# Prompt 1.0 - Arch v3.0 - Implementation Plan Adjustments

# Tasks

## Task 1 - Read and Uunderstand Architecture and Project Status

    Based on the documents read and knowledge available in the Memory Bank System preform the following sub-tasks.

    1.1 - Understand latest version of the Architecture.

        - Understand how the Architecture eveolved between version 2.3 and 3.0

        - Understand how the implementation location changed (from ~/Workspace/Pulumi-2 to ~/Workspace/cloud) and some of the directories have been created.

        - Undestand that the latest version (3.0) hasnt been implemented yet and the current work is preparation for the implementation of the Architecture.

    1.2 - Understand the existing stacks under ~/Workspace/Pulumi-2/aws/build/<stack>/v2/

        <stacks_directories>
        - ~/Workspace/Pulumi-2/aws/build/<stack>/v2/    
        - ~/Workspace/Pulumi-2/aws/build/<stack>/v2/docs
        - ~/Workspace/Pulumi-2/aws/build/<stack>/v2/resources
        </stacks_directories>

        - Understand the overall stack structures under Arch.v2.3 and the new stack structures under Arch3.0

        - Understand what each stack does.

        - Understand the purpose of the MD documents under the docs directory of each stack.

    1.3 - Read and understand additional contextual documents:

        - ~/Workspace/Pulumi-2/admin/v2/docs/Prompt-11 - Pre-Implementation - Responses.md

        OBSERVATION: 
            - This file used to be ""Answers_Pre-Implementation.2.3.md", but it has been renamed.
            - This document uses the new filename ("Prompt-11 - Pre-Implementation - Responses.md").

    1.4 - Read this whole document.

        - Understand all of the tasks below, individually and as a whole.
  
        IMPORTANT: 
        
        Start planning ONLY after all tasks are read.

## Task 2 - Understand Architecture discrepancies

    2.1 - The Multi_Stack_Architecture.3.0.md document should have described the Directory Structure in detail, starting on line 680 ("### Complete Platform Directory Layout"). However, it does not seem to be complete below the "tools/templates/" section. Just confirm or deny this discrepancy and be aware of it.
   
    2.2 - Addendum_Platform_Code.3.0

    - Deploy directory name doesn't have organization and project.
    - Tools Dir doesn't have templates/docs and templates/src
    - Just confirm or deny this discrepancy and be aware of them.

    2.3 - Verify and Identify

    - Understand the spotted discrepancies.
    - Verify all documents under ~Workspace/claude/tools/docs, searching and thinking deep about possible additional discrepancies,  inconsistencies or lack of completeness.
    - Identify all of the additional discrepancies.
    - List all docs that would need to be replaced, in order for the documentation to be 100% correct and complete.

# Task 3 - Adjust Directory Structure

    3.1 - This is one of the main Tasks in this session. Use the Directory_Structure_Diagram.3.0.md as a reference to:

        - Have deep AND wide understanding of the directory structure in the referred document, as well as all of its subdirectories and related functionality in the architecture. This is extremely important. Think deep and long about all of this - do not rush.
        
        - Plan the few adjustments that need to be made to the directory structure, as the document describes (a few missing directories or changes in directory names, for example).
        
        - Plan the adjustments to correct all of the discrepancies already identified.

    3.2 - Verify all documents and identify which documents and sections need adjustments:

        - Look for diagrams and plan the respective adjustments
        - Look for tools and plan the respective adjustments
        - Look for stacks and plan the respective adjustments
        - Look for deployments and plan the respective adjustments 
        - Look for code and plan the respective adjustments

    3.3- Provide a short plan (but do not execute it, until approved) to:
    
        - Create new, additional documents, to be used as replacement, reflecting the corrected discrepancies and instructed adjustments (according to 3.1 above).
        
        - New replacement documents should use version 3.1, instead of 3.0.

## Task 4 - Adjust Pulumi State Management Structure

    4.1 - The State Management section (starting on  line 1916) of the Multi_Stack_Architecture.3.0.md document describes a Pulumi stack naming convention that seems to have some deficiencies.

    <snippet>
        **Stack Organization in Pulumi Cloud:**
        ```
        Pulumi Organization: companyA
        ├── Project: network
        │   ├── Stack: D1BRV40-dev
        │   ├── Stack: D1BRV40-stage
        │   └── Stack: D1BRV40-prod
        ├── Project: security
        │   ├── Stack: D1BRV40-dev
        │   ├── Stack: D1BRV40-stage
        │   └── Stack: D1BRV40-prod
        └── ... (14 more projects)
        ```
    </snippet>

    The above structure:
        Pulumi Organization = <organization>
        Pulumi "Project" = <stack>
        Pulumi "Stack" = <deployment-id>-<environment>

    The above structure has the following deficiencies:
        - Arch.v3 stacks treated as Projects.
        - No clear way to group stacks by project.

    4.2 - However based on the deplyment directory structure, (defined by the Directory_Structure_Diagram.3.0.md document), it seems we could have a better structure for Pulumi State Management. 

    <snippet>  
        **Stack Organization in Pulumi Cloud:**
        ```
        │   └── deploy/                               # Active Deployments
        │       ├── D1BRV40-CompanyA-ecommerce/       # Deployment Example 1
        │       │   ├── Deployment_Manifest.yaml  # Deployment configuration
        │       │   ├── config/
        │       │   │   ├── network.dev.yaml          # Network dev config
        │       │   │   ├── network.staging.yaml      # Network staging config
        │       │   │   ├── network.prod.yaml         # Network prod config
        │       │   │   ├── dns.dev.yaml
        │       │   │   ├── dns.staging.yaml
        │       │   │   ├── dns.prod.yaml
        │       │   │   └── ... (all stacks × environments)
        │       │   └── logs/
        │       │       ├── init.log
        │       │       ├── deploy-dev-20251003-143000.log
        │       │       └── deploy-staging-20251004-091500.log
        │       │
        │       ├── D1BRV45-CompanyB-mobile/          # Deployment Example 2
        │       │   └── (same structure)
        │       │
        │       └── D1BRV50-CompanyA-analytics/       # Deployment Example 3
        │           └── (same structure)
        ```
    </snippet>  

    4.3 - Proposed Structure for Pulumi State Management

    Pulumi Organization = <organization>
    Pulumi "Project" = <project>
    Pulumi "Stack" = <deployment-id>-<environment>

    <snippet>
        Pulumi Organization: CompanyA
        ├── Project: ecommerce
        │   ├── Stack: D1BRV40-network-dev
        │   ├── Stack: D1BRV40-network-stage
        │   └── Stack: D1BRV40-network-prod
        │   ├── Stack: D1BRV40-dns-dev
        │   ├── Stack: D1BRV40-dns-stage
        │   └── Stack: D1BRV40-dns-prod
        ├── Project: blabla-project
        │   ├── Stack: D1BRV41-network-dev
        │   ├── Stack: D1BRV41-network-stage
        │   └── Stack: D1BRV41-network-prod
        │   ├── Stack: D1BRV41-dns-dev
        │   ├── Stack: D1BRV41-dns-stage
        │   └── Stack: D1BRV41-dns-prod
    </snippet>

    4.4 - The following is also one of the main Tasks in this session.

        - Have deep AND wide understanding of the proposed Pulumi State Management structure above and ALL of the consequences of its adoption in the revised architecture (3.1). This is extremely important. Think deep and long about all of this - do not rush.
        
        - Plan ALL of the adjustments that need to be made to the overall architecture. This is extremely important. Think deep and long about all of this - do not rush.
        
    4.5 - Verify all documents and identify which documents and sections need adjustments:

        - Look for diagrams and plan the respective adjustments
        - Look for tools and plan the respective adjustments
        - Look for stacks and plan the respective adjustments
        - Look for deployments and plan the respective adjustments 
        - Look for code and plan the respective adjustments

    4.6- Provide a short plan (but do not execute it, until approved) to:
    
        - Make ALL of the necessary changes to adopt the new Pulumi State Management structure.
        
        - Create new, additional documents, to be used as replacement, reflecting the proposed changes (according to 4.1 above), or include said changes in the new documents created on section "# Tsk 3", above.
        
        - New replacement documents should use version 3.1, instead of 3.0.

# Task 5

    - Understand the Implementation Plan, split into 3 Claude Code sessions; as outlined in the Execution_Feasibility_Analysis.md document.

    - Understand that we are are still on "Session 1" (Architecture review and implementation preparation).

